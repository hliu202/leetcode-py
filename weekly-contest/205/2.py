from util.common_imports import *
class Solution:
    def numTriplets(self, nums1: List[int], nums2: List[int]) -> int:
        nums1.sort()
        nums2.sort()

        def cal(n1, n2):
            ans = 0
            last1 = n1[0] -1
            last_ans = 0

            for i in range(0, len(n1)):
                # !相等情況1
                if last1 == n1[i]:
                    ans += last_ans
                    continue

                j = 0
                k = len(n2) - 1
                cur1 = n1[i] * n1[i]

                last_ans = 0
                while j < k:
                    cur2 = n2[j] * n2[k]
                    if cur1 == cur2:
                        last_ans += 1
                        # !相等情況2
                        kk = k - 1
                        while kk > j and n2[kk] == n2[k]:
                            last_ans += 1
                            kk -= 1

                        j += 1
                    elif cur1 < cur2:
                        k -= 1
                    else:
                        j += 1
                last1 = n1[i]
                ans += last_ans

            return ans

        c1 = cal(nums1, nums2)
        c2 = cal(nums2, nums1)
        return c1 + c2

print(Solution().numTriplets(nums1 = [7,4], nums2 = [5,2,8,9]))
print(Solution().numTriplets(nums1 = [1,1], nums2 = [1,1,1]))
print(Solution().numTriplets(nums1 = [7,7,8,3], nums2 = [1,2,9,7]))
print(Solution().numTriplets(nums1 = [4,7,9,11,23], nums2 = [3,5,1024,12,18]))
# [2,2,2,1,1,1,1,2,2,2,2,2,2,2,1,2,1,1,1,1,2,1,1,2,2,2,2,1,2,1,2,2,1,2,1,2,1,2,1,1,2,2,1,1,1,1,2,1,2,2,1,2,2,2,2,1,1,1,2,2,2,1,2,2,1,1,1,2,1,1,1,2,2,1,2,2,1,2,2,2,1,1,1,1,2,1,1,2,2,2,2,2,1,2,1,2,1,1,2,2,1,2,1,1,2,2,2,1,1,2,1,1,2,2,1,2,2,2,2,2,1,1,2,2,1,1,2,2,2,2,2,1,1,1,1,1,1,2,1,2,2,2,2,1,2,2,1,2,2,1,2,1,2,2,1,2,1,1,2,2,1,2,2,2,2,2,1,1,1,2,1,2,2,1,1,1,2,2,1,1,1,1,2,2,2,1,2,1,2,1,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,2,1,2,2,2,1,2,1,2,2,1,2,2,2,1,1,1,1,2,2,1,2,2,1,2,1,2,1,1,1,1,2,1,2,1,2,2,2,2,1,1,2,2,2,2,1,2,1,1,2,1,2,1,2,2,1,2,2,2,2,2,1,1,1,2,1,2,2,1,1,2,1,2,2,1,2,1,2,2,2,2,2,2,1,2,2,1,1,1,2,2,2,1,2,2,1,1,1,1,1,2,1,2,2,2,1,2,2,1,2,1,2,1,1,1,1,2,2,2,2,1,1,2,1,1,2,2,2,2,1,2,2,2,2,2,1,2,1,2,2,1,2,1,1,2,2,1,2,1,2,2,1,2,1,1,2,1,2,1,1,1,1,2,1,2,1,2,2,2,2,1,2,2,2,2,1,2,1,1,2,2,2,1,1,2,2,1,2,1,2,1,2,2,1,1,2,2,1,2,2,1,1,2,1,2,2,1,1,2,1,1,2,1,1,1,2,1,1,2,1,2,1,1,2,2,1,2,1,2,1,1,2,2,2,1,2,1,2,1,2,2,2,1,1,1,1,1,1,1,2,1,2,2,1,2,1,1,1,2,1,1,2,2,1,2,2,1,1,2,2,1,1,2,2,1,1,2,1,1,1,1,1,2,2,1,2,1,1,2,1,1,2,2,2,1,1,2,1,1,1,1,2,1,1,1,2,2,2,1,2,1,1,1,2,2,1,1,2,1,2,1,1,1,2,2,2,2,1,1,2,1,1,1,2,2,2,1,2,2,2,2,1,2,1,1,2,1,1,2,1,1,1,2,2,1,2,2,1,2,1,1,2,2,2,1,2,2,2,1,2,1,1,2,1,2,2,1,2,2,2,1,1,2,1,2,2,2,2,1,1,1,2,1,1,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,2,2,1,1,2,2,1,2,2,2,1,1,2,2,2,1,2,2,2,2,1,1,1,2,1,1,1,1,2,1,1,2,1,1,2,1,1,1,2,1,1,2,2,1,1,2,2,1,1,2,2,2,1,1,2,1,2,1,2,2,1,1,1,1,2,2,2,2,1,2,2,2,2,1,1,1,2,1,1,1,1,2,1,2,2,2,2,1,2,1,1,1,2,2,1,2,2,1,1,1,1,2,2,1,1,2,2,1,2,1,1,1,2,2,1,2,2,1,2,2,2,1,2,2,2,1,1,1,2,1,1,1,1,1,1,2,2,2,2,1,1,2,2,2,2,2,2,2,1,2,1,1,1,1,2,2,1,1,1,2,2,2,1,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,1,2,1,2,1,1,2,1,2,1,1,2,1,2,2,2,1,1,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,1,2,2,1,2,1,2,2,1,1,1,2,2,1,1,2,1,2,1,1,2,2,2,1,2,1,1,2,2,2,1,2,2,1,1,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,2,2,1,2,2,1,1,1,1,1,1,1,2,1,1,2,1,2,1,1,1,2,2,2,1,2,1,2,2,1,1,1,2,2,1,2,2,2,1,1,1,1,2,1,2,1,1,1,1,2,2,2,1,1,2,2,2,1,1,1,1,1,2,1,2,1,1,2,1,2,2,1,1,2,2,1,2,1,2,1,1,4]
# [1,1,2,1,1,1,2,1,2,1,1,1,2,1,2,2,1,2,2,1,2,1,2,2,2,2,2,1,2,2,1,1,1,1,1,1,2,2,2,1,2,1,1,2,2,1,2,2,1,2,2,1,1,2,1,1,2,1,2,2,2,1,1,1,2,1,2,2,2,1,2,1,2,1,2,2,2,1,1,1,1,1,1,1,2,2,2,2,1,2,2,2,1,1,1,2,1,1,1,2,1,1,2,1,2,2,1,2,2,2,1,2,1,2,1,2,1,1,2,1,2,2,2,1,1,1,2,2,2,2,1,2,1,1,2,1,1,1,1,1,2,2,1,2,1,2,1,1,1,1,2,1,1,1,2,1,2,2,2,1,1,2,2,2,2,2,1,1,2,2,1,1,2,2,2,1,1,1,2,1,2,1,1,2,2,1,1,1,1,1,2,1,2,1,2,1,2,1,2,1,1,1,1,2,2,2,1,2,1,2,1,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,1,1,1,1,1,2,1,2,1,2,1,2,2,2,2,2,1,1,1,2,1,2,1,1,2,2,1,2,2,1,2,1,2,1,1,1,1,2,1,2,2,2,2,1,2,2,1,2,1,1,1,2,2,1,2,1,2,1,1,1,1,1,2,2,1,1,1,2,1,1,1,2,2,1,2,1,1,2,2,2,2,1,1,2,1,1,1,2,2,2,2,1,2,1,2,1,1,1,2,2,2,1,1,1,1,2,1,1,2,1,2,2,1,1,1,1,1,1,1,1,2,2,1,2,1,2,1,2,1,2,1,2,2,2,2,1,2,2,2,1,2,2,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,1,2,2,2,1,2,1,1,1,1,1,1,2,2,1,1,2,2,2,1,2,1,1,2,1,1,1,2,2,2,1,2,1,2,2,1,1,1,2,1,1,1,1,2,1,2,1,2,2,1,1,1,1,1,1,1,2,1,1,2,2,1,1,2,2,2,1,1,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,1,1,1,2,1,1,1,1,1,2,1,1,2,2,1,1,2,1,2,1,1,1,1,1,1,2,1,2,1,2,1,1,2,2,1,1,1,1,2,1,2,2,2,1,1,1,1,1,2,2,2,2,2,1,1,1,1,1,2,2,1,1,2,2,1,1,2,1,2,1,2,1,2,1,2,2,1,2,2,2,1,1,2,1,2,2,1,2,2,1,2,1,1,1,2,2,2,2,2,2,2,2,2,1,1,1,2,1,2,2,2,2,2,1,1,1,1,2,2,2,1,1,2,1,1,2,2,1,2,2,1,2,1,2,2,1,2,2,1,2,2,1,1,1,2,1,2,2,1,2,2,1,2,1,2,2,2,2,1,2,2,1,2,2,2,2,2,1,1,1,1,2,1,2,1,2,1,2,1,2,1,2,2,1,1,2,2,2,2,1,2,2,2,2,2,1,1,1,1,1,2,2,1,1,1,1,1,2,2,1,1,1,2,1,2,2,2,1,2,1,1,2,2,1,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,2,1,2,1,2,1,2,2,1,1,2,1,2,1,1,1,2,1,2,1,2,2,1,2,1,2,2,2,2,1,1,1,1,2,2,1,1,1,1,2,1,1,2,2,2,2,2,2,1,1,1,1,2,2,1,2,1,2,2,1,2,1,2,1,1,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,1,2,2,1,1,1,1,2,2,2,1,1,2,1,1,2,1,2,1,1,2,2,2,2,2,1,1,2,2,2,1,2,1,2,2,2,2,2,2,2,1,2,2,1,1,2,1,2,1,2,2,1,2,2,2,2,2,2,1,2,1,2,1,1,2,2,2,1,1,2,2,1,1,1,1,2,1,2,2,1,2,2,1,2,2,1,1,1,1,2,1,2,1,2,1,1,2,2,1,2,1,1,1,1,2,2,2,1,1,1,1,1,1,2,2,1,2,2,2,1,2,1,1,2,1,1,1,2,2,2,2,1,1,1,2,2,2,1,1,2,2,1,2,2,1,1,1,2,2,2,1,1,1,1,2,1,1,1,2,2,1,2,1,2,1,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,1,1,2,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,2,2,1,1,1] # 超時